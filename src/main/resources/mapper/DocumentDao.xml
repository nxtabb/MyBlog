<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hrbeu.dao.DocumentDao">
    <resultMap id="document_index" type="com.hrbeu.pojo.Document">
        <id column="document_id" property="documentId"/>
        <result column="title" property="title"/>
        <result column="last_edit_time" property="lastEditTime"/>
        <result column="recommend" property="recommend"/>
        <association property="type" javaType="com.hrbeu.pojo.Type">
            <id column="type_id" property="typeId"/>
            <result column="type_name" property="typeName"/>
        </association>
    </resultMap>
    <select id="queryDocument" parameterType="long" resultMap="document_index">
        select doc.*,type.type_id,type.type_name
        from
        tb_document doc,tb_type type
        where
        doc.type_id = type.type_id
        and
        doc.document_id = #{value }
    </select>


    <select id="getDocumentList" resultMap="document_index">
        select doc.*, type.type_name
        from
        tb_document doc,tb_type type
        <where>
        doc.type_id = type.type_id
        <if test="document!=null and document.title!=null">
            and doc.title = #{document.title}
        </if>
        <if test="document!=null and document.type!=null and document.type.typeId!=null">
            and doc.type_id = #{document.type.typeId}
        </if>
        <if test="document!=null and document.recommend!=null">
            and doc.recommend = #{document.recommend}
        </if>
        </where>
        limit #{documentIndex},#{pageSize}
    </select>

    <select id="getList" resultMap="document_index">
        select doc.*, type.type_name
        from
        tb_document doc,tb_type type
        <where>
            doc.type_id = type.type_id
            <if test="document != null and document.title != null">
                and doc.title = #{document.title}
            </if>
            <if test="document != null and document.type != null and document.type.typeId != null">
                and doc.type_id = #{document.type.typeId}
            </if>
            <if test="document != null and document.recommend != null">
                and doc.recommend = #{document.recommend}
            </if>
        </where>
    </select>

    <select id="documentCount" parameterType="com.hrbeu.pojo.Document" resultType="int">
        select count(*)
        from
        tb_document doc
        <where>
        <if test="document!=null and document.documentId!=null">
            and doc.document_id = #{document.documentId}
        </if>
        <if test="document!=null and document.title!=null">
            and doc.title = #{document.title}
        </if>
        <if test="document!=null and document.type!=null and document.type.typeId!=null">
            and doc.type_id = #{document.type.typeId}
        </if>
        <if test="document!=null and document.recommend!=null">
            and doc.recommend = #{document.recommend}
        </if>
        </where>
    </select>

    <delete id="deleteDocument" parameterType="long">
        delete from tb_document where document_id = #{value }
        </delete>

</mapper>